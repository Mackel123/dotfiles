#!/usr/bin/env bash

alias cp="cp -iv"
alias mv="mv -iv"
alias md="mkdir -pv"
alias rm="rm -iv"
alias c="clear"
alias ka="killall"
alias ydv="youtube-dl --add-metadata --restrict-filenames -i"
alias yda="ydv -x -f bestaudio/best"
alias ls="gls -hFN --color=auto --group-directories-first" # use GNU ls (brew install coreutils)
alias grep="grep --color=auto"
alias diff="diff --color=auto" # GNU diffutils required (brew install diffutils)
alias iftop="sudo /usr/local/sbin/iftop"
alias t="trash -Fv"

# z.lua
alias zl="z -l"
alias zc="z -c"
alias zb="z -b"
alias zi="z -i"
alias zf="z -I"

# Improved
alias idu="ncdu --color dark -rr -x --exclude .git --exclude node_modules"
alias icat="highlight --out-format=ansi"

# Use neovim for vim if present
command -v nvim >/dev/null && alias vim="nvim" vi="nvim" v="nvim" vimdiff="nvim -d"

# Dotfiles management
alias cfg="git --git-dir=$HOME/dotfiles/ --work-tree=$HOME"

# Convert video to GIF (with 2K resolution) using ffmpeg
# Usage: vtg input_name output_name, then output_name.gif will be generated
alias vtg='function video_to_gif(){ ffmpeg -i $1 -pix_fmt rgb8 -r 10 -vf scale=2560:-1 $2.gif && gifsicle -O3 $2.gif -o $2.gif && osascript -e "display notification \"$2.gif successfully converted and saved\" with title \"VIDEO2GIF SUCCESS!\""};video_to_gif'

# When quitting ranger using Z, change the shell pwd to the last visited directory
function ranger {
    local IFS=$'\t\n'
    local tempfile="$(mktemp -t tmp.XXXXXX)"
    local ranger_cmd=(
        command
        ranger
        --cmd="map Z chain shell echo %d > "$tempfile"; quitall"
    )

    ${ranger_cmd[@]} "$@"
    if [[ -f "$tempfile" ]] && [[ "$(cat -- "$tempfile")" != "$(echo -n `pwd`)" ]]; then
        cd -- "$(cat "$tempfile")" || return
    fi
    command rm -f -- "$tempfile" 2>/dev/null
}
alias ra="ranger"

# Quick navigation (Jump)
alias Jg="cd ~/gitrepos"
alias Jd="cd ~/Documents"
alias JD="cd ~/Downloads"
alias Jb="cd ~/Dropbox"
alias Jcg="cd ~/.config"
alias Jcb="cd ~/.config/bin"
alias Jcz="cd ~/.config/zsh"
alias Jcv="cd ~/.config/nvim"
alias Jcm="cd ~/.config/nvim/pack/minpac"
alias Jcr="cd ~/.config/ranger"
alias Jcy="cd ~/.config/yabai"
alias Jck="cd ~/.config/skhd"
alias Jcf="cd ~/.config/fzf"

# Quick edit (Config)
alias Cv="$EDITOR ~/.config/nvim/init.vim"
alias Cz="$EDITOR ~/.config/zsh/.zshrc"
alias Ca="$EDITOR ~/.config/zsh/aliases"
alias Ce="$EDITOR ~/.config/zsh/env"
alias Cr="$EDITOR ~/.config/ranger/rc.conf"
alias Cy="$EDITOR ~/.config/yabai/yabairc"
